<UserControl
    x:Class="SchedulingApp.Views.ShiftView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Converters="clr-namespace:SchedulingApp.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:hc="https://handyorg.github.io/handycontrol"
    xmlns:local="clr-namespace:SchedulingApp.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodels="clr-namespace:SchedulingApp.ViewModels"
    d:DataContext="{d:DesignInstance Type=viewmodels:ShiftViewModel}"
    d:DesignHeight="600"
    d:DesignWidth="800"
    mc:Ignorable="d">
    <UserControl.Resources>
        <Converters:ColorConverter x:Key="ColorConverter" />
    </UserControl.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <hc:UniformSpacingPanel
            Grid.Row="0"
            Margin="0,0,0,10"
            Orientation="Horizontal"
            Spacing="10">
            <Button
                Width="100"
                Command="{Binding AddShiftCommand}"
                Content="添加班次"
                FontSize="14" />
            <Button
                Width="100"
                Command="{Binding EditShiftCommand}"
                CommandParameter="{Binding ElementName=ShiftDataGrid, Path=SelectedItem}"
                Content="编辑班次"
                FontSize="14" />
            <Button
                Width="100"
                Command="{Binding DeleteShiftCommand}"
                CommandParameter="{Binding ElementName=ShiftDataGrid, Path=SelectedItems}"
                Content="删除班次"
                FontSize="14" />
            <Button
                Width="100"
                Command="{Binding DownloadShiftTemplateCommand}"
                Content="下载模板"
                FontSize="14" />
            <Button
                Width="100"
                Command="{Binding UploadShiftFileCommand}"
                Content="上传文件"
                FontSize="14" />
        </hc:UniformSpacingPanel>

        <DataGrid
            x:Name="ShiftDataGrid"
            Grid.Row="1"
            hc:DataGridAttach.ShowRowNumber="True"
            AutoGenerateColumns="False"
            BorderBrush="{DynamicResource BorderBrush}"
            ItemsSource="{Binding Shifts}"
            SelectedItem="{Binding SelectedShift}"
            SelectionUnit="FullRow">
            <DataGrid.Columns>
                <DataGridTextColumn
                    Width="*"
                    Binding="{Binding ShiftName}"
                    Header="班次名称" />
                <DataGridTextColumn
                    Width="*"
                    Binding="{Binding StartTime}"
                    Header="开始时间" />
                <DataGridTextColumn
                    Width="*"
                    Binding="{Binding EndTime}"
                    Header="结束时间" />
                <DataGridTemplateColumn Width="80" Header="颜色">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Rectangle
                                Width="30"
                                Height="20"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Fill="{Binding Color, Converter={StaticResource ColorConverter}}"
                                Stroke="{DynamicResource BorderBrush}"
                                StrokeThickness="1" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</UserControl>